---
layout: page
title: QPi
permalink: /qpi/
---

# Index

* [Introduction](#introduction)
* [Project Status](#project-status)
* [AUR recipes](#aur-recipes)
* [Arch repo](#arch-repo)
* [Instructions](#instructions)

# Overview

QPi is an attempt to create a convenient [Qt](https://www.qt.io/) SDK for the Raspberry Pi 0/1/2/3 on Arch Linux. You click a button in Qt Creator, your application is automagically deployed and run on the board, without X11 involvement. (The tooling facilitates this, this is primarily a packaging initiative with a little polish required)

# Introduction

<iframe width="560" height="315" src="https://www.youtube.com/embed/vNMQMlucKco" frameborder="0" allowfullscreen></iframe>

The primary goal is to ensure full functionality of Qt on the Raspberry Pi, and to ease the overhead/complexity of cross compilation from desktop Arch installs to Arch based Raspberry Pis.

Qt can run quite nicely on the Pi(s), as long as you are not running it under Xorg/X11. The packaged versions of Qt run the gamut, but I have yet to see a Qt packaging which targets kms/console usage, or which has functional wayland support (outside of Intel hardware) as shipped.

I happen to be a big fan of cross compilation rather than compilation on target, which simply removes all joy from iterative development. We provide 2 packages, one for the Raspberry Pi and one for the host machine, which once installed allow you to cross compile for the Raspberry Pi from your Arch host machine. These packages are simply tar balls, so they should even run outside of Arch in a suitably modern Linux install. (The packaging is frosting)

# Project Status

* Qt 5.9.0
* CEC input support is currently alpha

# Known issues

* Single applications can run well with eglfs at 1080p. I have not been able to get wayland working well on the Raspberry Pi at anything other than 720p.
* aarch64 support is barred by numerous logistic issues at present.
* Allocate lots of graphical memory if you intend to run GLES2 apps. I allocate 512 MB on the Raspberry Pi 2 and 256 MB on the Pi Zero.

# Platform Notes

## Raspberry Pi 0/1(armv6)2/3(armv7)

uses the vc stack and the propietary drivers/blobs (and has CEC support). 2 Packages split along architectual lines.

## Raspberry Pi 3 (aarch64)

uses the mesa stack.

# AUR recipes

These [AUR recipe(s)](https://aur.archlinux.org/cgit/aur.git/tree/PKGBUILD?h=qt-sdk-raspberry-pi) are used to generate my Qt SDK packages

# Arch repo

```
[qpi]
SigLevel = Optional
Server = http://s3.amazonaws.com/spuddrepo/repo/$arch
```

This repo is equipped with packages generated by the above recipe, packages you can either directly consume, or ingest by way of magical (read dangerous) bash scripts which you can embrace in disdain for your sovereignty. Proceed at your own risk, and neither myself nor my employer provide any binding guarantees or assurances. Kiss your poodle goodbye.

# Instructions

0. Proceed at your own risk
0. [Install the appropriate Arch on a fresh sd card](https://archlinuxarm.org/platforms/armv7/broadcom/raspberry-pi-2)
0. Boot the Raspberry Pi
0. Download and run the following [script](http://www.chaos-reins.com/scripts/setup_qpi.sh) on the RPI
0. I personally normally do this by allowing root login via ssh and then grabbing the script via curl
0. curl http://www.chaos-reins.com/scripts/setup_qpi.sh > setup_qpi.sh
0. bash setup_qpi.sh
0. I would strongly recommend increasing the video ram to 512 in /boot/config.txt. When using the mesa stack (The Pi 3) the contents of config.txt are ignored, and you have to stipulate the graphical memory via a kernel commandline argument: cma=512
0. Run this [script](http://www.chaos-reins.com/scripts/setup_qpi_host.sh) on your Arch host machine
0. Mount your Arch sysroot on your host (recommend NFS, mounting "/" under /mnt/pi{version})
0. You are now set to use Qt Creator to develop and deploy to your Raspberry Pi
0. Please note, you might have to explicitly "test" the device in the device page of Qt Creator in order for deployment to work. (pessimistic)
